From d75d8461bce67af9c6dbf7b82e85b4607b08f143 Mon Sep 17 00:00:00 2001
From: Guillaume Seren <guillaumeseren@gmail.com>
Date: Sat, 25 Apr 2020 21:55:35 +0200
Subject: [PATCH] Fix loading test

This reverts commit bc9525356632c640048d0d55d5e67b9ce25c3f15.
---
 test/testall.py | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/test/testall.py b/test/testall.py
index 418b4a3c..88eb7011 100755
--- a/test/testall.py
+++ b/test/testall.py
@@ -22,15 +22,16 @@ import re
 import sys
 import unittest
 
-pkgpath = os.path.dirname(os.path.dirname(os.path.realpath(__file__))) or '..'
-sys.path.insert(0, pkgpath)
+pkgpath = os.path.dirname(__file__) or '.'
+sys.path.append(pkgpath)
+os.chdir(pkgpath)
 
 
 def suite():
     s = unittest.TestSuite()
     # Get the suite() of every module in this directory beginning with
     # "test_".
-    for fname in os.listdir(os.path.join(pkgpath, 'test')):
+    for fname in os.listdir(pkgpath):
         match = re.match(r'(test_\S+)\.py$', fname)
         if match:
             modname = match.group(1)
-- 
2.26.2

